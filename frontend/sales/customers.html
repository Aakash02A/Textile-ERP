<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customers - Textile ERP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #f5f7fa;
        }

        .customer-card {
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .customer-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .status-active {
            background-color: #d1fae5;
            color: #065f46;
        }

        .status-inactive {
            background-color: #fee2e2;
            color: #7f1d1d;
        }
    </style>
    <script src="../../js/erp-data-manager.js"></script>
    <script src="../../js/mock-backend.js"></script>
    <script src="../../js/erp-helper.js"></script>
    <script src="../../js/erp-utilities.js"></script>
    <script src="../../js/erp-handlers.js"></script>
</head>
<body class="bg-gray-50">
    <div class="p-8">
        <div class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-3xl font-bold text-gray-900">Customers</h1>
                <p class="text-gray-600 mt-2">Manage customer information and relationships</p>
            </div>
            <button onclick="openCreateCustomer()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition font-medium">
                <i class="fas fa-plus mr-2"></i>Add Customer
            </button>
        </div>

        <!-- Search -->
        <div class="bg-white rounded-lg shadow p-4 mb-6">
            <input type="text" name="searchCustomer" placeholder="Search customers by name, email, or location..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" onchange="filterCustomers()">
        </div>

        <!-- Customers Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Customer Card 1 -->
            <div class="bg-white rounded-lg shadow p-6 customer-card border-l-4 border-green-500">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="text-lg font-bold text-gray-900">ABC Textiles Ltd</h3>
                        <p class="text-sm text-gray-600">Established 2015</p>
                    </div>
                    <span class="inline-block px-3 py-1 bg-green-100 text-green-800 text-xs font-semibold rounded-full status-active">Active</span>
                </div>
                <div class="space-y-2 text-sm mb-4">
                    <p class="text-gray-700"><i class="fas fa-envelope mr-2 text-blue-500"></i><span class="font-medium">contact@abctex.com</span></p>
                    <p class="text-gray-700"><i class="fas fa-phone mr-2 text-blue-500"></i><span class="font-medium">+1-555-0123</span></p>
                    <p class="text-gray-700"><i class="fas fa-map-marker-alt mr-2 text-blue-500"></i><span class="font-medium">New York, USA</span></p>
                </div>
                <div class="border-t pt-4">
                    <p class="text-xs text-gray-600">Total Orders: <span class="font-bold text-gray-900">12</span></p>
                    <p class="text-xs text-gray-600 mt-1">Total Revenue: <span class="font-bold text-gray-900">$125,000</span></p>
                </div>
            </div>

            <!-- Customer Card 2 -->
            <div class="bg-white rounded-lg shadow p-6 customer-card border-l-4 border-green-500">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="text-lg font-bold text-gray-900">Fashion World Inc</h3>
                        <p class="text-sm text-gray-600">Established 2010</p>
                    </div>
                    <span class="inline-block px-3 py-1 bg-green-100 text-green-800 text-xs font-semibold rounded-full status-active">Active</span>
                </div>
                <div class="space-y-2 text-sm mb-4">
                    <p class="text-gray-700"><i class="fas fa-envelope mr-2 text-blue-500"></i><span class="font-medium">sales@fashionworld.com</span></p>
                    <p class="text-gray-700"><i class="fas fa-phone mr-2 text-blue-500"></i><span class="font-medium">+44-20-7946-0958</span></p>
                    <p class="text-gray-700"><i class="fas fa-map-marker-alt mr-2 text-blue-500"></i><span class="font-medium">London, UK</span></p>
                </div>
                <div class="border-t pt-4">
                    <p class="text-xs text-gray-600">Total Orders: <span class="font-bold text-gray-900">8</span></p>
                    <p class="text-xs text-gray-600 mt-1">Total Revenue: <span class="font-bold text-gray-900">$87,500</span></p>
                </div>
            </div>

            <!-- Customer Card 3 -->
            <div class="bg-white rounded-lg shadow p-6 customer-card border-l-4 border-green-500">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="text-lg font-bold text-gray-900">Premium Wear Co</h3>
                        <p class="text-sm text-gray-600">Established 2018</p>
                    </div>
                    <span class="inline-block px-3 py-1 bg-green-100 text-green-800 text-xs font-semibold rounded-full status-active">Active</span>
                </div>
                <div class="space-y-2 text-sm mb-4">
                    <p class="text-gray-700"><i class="fas fa-envelope mr-2 text-blue-500"></i><span class="font-medium">info@premiumwear.com</span></p>
                    <p class="text-gray-700"><i class="fas fa-phone mr-2 text-blue-500"></i><span class="font-medium">+33-1-42-86-82-00</span></p>
                    <p class="text-gray-700"><i class="fas fa-map-marker-alt mr-2 text-blue-500"></i><span class="font-medium">Paris, France</span></p>
                </div>
                <div class="border-t pt-4">
                    <p class="text-xs text-gray-600">Total Orders: <span class="font-bold text-gray-900">15</span></p>
                    <p class="text-xs text-gray-600 mt-1">Total Revenue: <span class="font-bold text-gray-900">$245,000</span></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        async function initializeCustomers() {
            try {
                LoadingManager.showOverlay('Loading customers...');
                const customers = await erp.loadCustomers();
                renderCustomersCards(customers);
                LoadingManager.hideOverlay();
            } catch (error) {
                LoadingManager.hideOverlay();
                notify.error(`Error loading customers: ${error.message}`);
            }
        }

        function renderCustomersCards(customers) {
            const grid = document.querySelector('.grid');
            grid.innerHTML = customers.map(customer => `
                <div class="bg-white rounded-lg shadow p-6 customer-card border-l-4 border-blue-500">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="text-lg font-bold text-gray-900">${customer.name}</h3>
                            <p class="text-sm text-gray-600">${customer.city || 'No city'}</p>
                        </div>
                        <span class="inline-block px-3 py-1 bg-green-100 text-green-800 text-xs font-semibold rounded-full">Active</span>
                    </div>
                    <div class="space-y-2 text-sm mb-4">
                        <p class="text-gray-700"><i class="fas fa-envelope mr-2 text-blue-500"></i><span>${customer.email}</span></p>
                        <p class="text-gray-700"><i class="fas fa-phone mr-2 text-blue-500"></i><span>${customer.phone}</span></p>
                    </div>
                    <div class="border-t pt-4">
                        <p class="text-xs text-gray-600">Total Orders: <span class="font-bold text-gray-900">${customer.orders || 0}</span></p>
                        <p class="text-xs text-gray-600 mt-1">Total Revenue: <span class="font-bold text-gray-900">${Utils.formatCurrency(customer.totalRevenue || 0)}</span></p>
                    </div>
                </div>
            `).join('');
        }

        function openCreateCustomer() {
            window.location.href = 'create-customer.html';
        }

        document.addEventListener('DOMContentLoaded', () => {
            initializeCustomers();
        });
    </script>
</body>
</html>