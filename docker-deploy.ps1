# Textile ERP - Docker Deployment Script (Windows PowerShell)\n# This script automates Docker setup and deployment\n\n$ErrorActionPreference = 'Stop'\n\n# Colors\n$Green = 'Green'\n$Red = 'Red'\n$Yellow = 'Yellow'\n$Cyan = 'Cyan'\n\nfunction Write-Info {\n    param([string]$Message)\n    Write-Host \"ℹ️  $Message\" -ForegroundColor $Cyan\n}\n\nfunction Write-Success {\n    param([string]$Message)\n    Write-Host \"✅ $Message\" -ForegroundColor $Green\n}\n\nfunction Write-Warning {\n    param([string]$Message)\n    Write-Host \"⚠️  $Message\" -ForegroundColor $Yellow\n}\n\nfunction Write-Error {\n    param([string]$Message)\n    Write-Host \"❌ $Message\" -ForegroundColor $Red\n}\n\n# Header\nClear-Host\nWrite-Host \"`n╔════════════════════════════════════════════════════════════╗\" -ForegroundColor $Cyan\nWrite-Host \"║     TEXTILE ERP - DOCKER DEPLOYMENT AUTOMATION            ║\" -ForegroundColor $Cyan\nWrite-Host \"╚════════════════════════════════════════════════════════════╝`n\" -ForegroundColor $Cyan\n\n# Check Docker\nWrite-Info \"Checking Docker installation...\"\nif (-Not (Get-Command docker -ErrorAction SilentlyContinue)) {\n    Write-Error \"Docker is not installed. Please install Docker Desktop.\"\n    exit 1\n}\n$dockerVersion = & docker --version\nWrite-Success \"$dockerVersion\"\n\nif (-Not (Get-Command docker-compose -ErrorAction SilentlyContinue)) {\n    Write-Error \"Docker Compose is not installed.\"\n    exit 1\n}\n$composeVersion = & docker-compose --version\nWrite-Success \"$composeVersion\"\n\n# Menu\nWrite-Host \"`nSelect operation:\" -ForegroundColor $Yellow\nWrite-Host \"  1) Setup and Start (Development)\"\nWrite-Host \"  2) Start Existing Services\"\nWrite-Host \"  3) Stop Services\"\nWrite-Host \"  4) View Logs\"\nWrite-Host \"  5) View Status\"\nWrite-Host \"  6) Restart Services\"\nWrite-Host \"  7) Clean Up (Remove containers and volumes)\"\nWrite-Host \"  8) Production Setup\"\nWrite-Host \" \"\n$choice = Read-Host \"Enter choice (1-8)\"\n\nswitch ($choice) {\n    \"1\" {\n        Write-Info \"`nStarting Development Setup...\"\n        \n        if (-Not (Test-Path '.env')) {\n            Write-Warning \"Creating .env file from .env.docker template\"\n            Copy-Item '.env.docker' '.env'\n            Write-Success \".env file created. Update if needed.\"\n        }\n        \n        Write-Info \"Building images and starting services...\"\n        & docker-compose build\n        & docker-compose up -d\n        \n        Write-Success \"`nServices started successfully!\"\n        Write-Info \"`nAccess points:\"\n        Write-Host \"  • Backend API: http://localhost:8000\"\n        Write-Host \"  • API Docs: http://localhost:8000/docs\"\n        Write-Host \"  • PgAdmin: http://localhost:5050\"\n        Write-Host \"  • Frontend: http://localhost\"\n        \n        Write-Info \"`nWaiting for services to be healthy...\"\n        Start-Sleep -Seconds 5\n        & docker-compose ps\n    }\n    \"2\" {\n        Write-Info \"`nStarting existing services...\"\n        & docker-compose start\n        Write-Success \"Services started!\"\n        & docker-compose ps\n    }\n    \"3\" {\n        Write-Info \"`nStopping services...\"\n        & docker-compose stop\n        Write-Success \"Services stopped!\"\n    }\n    \"4\" {\n        Write-Info \"`nShowing logs (Press Ctrl+C to exit)...\"\n        & docker-compose logs -f\n    }\n    \"5\" {\n        Write-Info \"`nService Status:\"\n        & docker-compose ps\n    }\n    \"6\" {\n        Write-Info \"`nRestarting services...\"\n        & docker-compose restart\n        Write-Success \"Services restarted!\"\n        & docker-compose ps\n    }\n    \"7\" {\n        Write-Warning \"`nThis will remove all containers and volumes!\"\n        $confirm = Read-Host \"Are you sure? (yes/no)\"\n        if ($confirm -eq 'yes') {\n            Write-Info \"Cleaning up...\"\n            & docker-compose down -v\n            Write-Success \"Cleanup complete!\"\n        } else {\n            Write-Info \"Cleanup cancelled.\"\n        }\n    }\n    \"8\" {\n        Write-Info \"`nSetting up for Production...\"\n        Write-Warning \"This requires additional configuration.\"\n        \n        if (-Not (Test-Path '.env.prod')) {\n            Write-Info \"Creating production .env file...\"\n            Copy-Item '.env.docker' '.env.prod'\n            Write-Warning \"`nPlease update .env.prod with production values:\"\n            Write-Host \"  1. POSTGRES_PASSWORD - Use strong password\"\n            Write-Host \"  2. SECRET_KEY - Generate new secure key\"\n            Write-Host \"  3. CORS_ORIGINS - Set your domain\"\n            Write-Host \"  4. DEBUG - Set to False\"\n        }\n        \n        Write-Info \"`nRun: docker-compose --env-file .env.prod up -d\"\n        $confirm = Read-Host \"Run this command? (yes/no)\"\n        if ($confirm -eq 'yes') {\n            & docker-compose --env-file .env.prod up -d\n            Write-Success \"Production deployment started!\"\n            & docker-compose ps\n        }\n    }\n    default {\n        Write-Error \"Invalid choice. Please run the script again.\"\n        exit 1\n    }\n}\n\nWrite-Host \"`n\" -ForegroundColor $Cyan\nWrite-Success \"Operation complete!\"\nWrite-Info \"For more information, see DOCKER_DEPLOYMENT.md\"\n"
